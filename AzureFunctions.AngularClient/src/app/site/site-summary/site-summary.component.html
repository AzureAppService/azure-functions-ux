<ng-sidebar-container class="sidebar-container" [animate]="true">
  <div ng-sidebar-content>
    <command-bar>
      <command [displayText]="context?.site.properties.state === 'Running' ? ts.instant(Resources.stop) : ts.instant(Resources.start)"
        [iconUrl]="context?.site.properties.state === 'Running' ? 'image/stop.svg' : 'image/start.svg'"
        (click)="toggleState()"
        [disabled]="!hasWriteAccess"></command>

      <command displayText="{{ 'swap' | translate }}"
        iconUrl="image/swap.svg"
        (click)="openSwapBlade()"
        [disabled]="!hasWriteAccess || !hasSwapAccess || context?.site.properties.targetSwapSlot !== null"></command>

      <command displayText="{{ 'restart' | translate }}"
        iconUrl="image/restart.svg"
        (click)="restart()"
        [disabled]="!hasWriteAccess || context?.site.properties.state !== 'Running'"></command>

      <command displayText="{{ 'downloadProfile' | translate}}"
        iconUrl="image/download.svg"
        (click)="downloadPublishProfile()"
        [disabled]="!hasWriteAccess"></command>

      <command displayText="{{'resetPubCredentials' | translate}}"
        iconUrl="image/reset.svg"
        (click)="resetPublishCredentials()"
        [disabled]="!hasWriteAccess"></command>

      <command displayText="{{ 'downloadFunctionAppContent' | translate}}"
        iconUrl="image/download.svg"
        (click)="openDownloadFunctionAppModal()"
        [disabled]="!hasWriteAccess"></command>

      <command *ngIf="containerMode == 'Dev'" displayText="Publish to Prod"
        iconUrl="image/scale-up.svg"
        (click)="publishApp()"
        [disabled]="!hasWriteAccess"></command>

      <command displayText="{{ '_delete' | translate }}"
        iconUrl="image/delete.svg"
        (click)="openDeleteBlade()"
        [disabled]="!hasWriteAccess"></command>
    </command-bar>

    <download-function-app-content (close)="hideDownloadFunctionAppModal()" *ngIf="showDownloadFunctionAppModal" [scmUrl]="context?.scmUrl"></download-function-app-content>

    <a id="hidden-publish-profile-link" *ngIf="!!publishProfileLink" [href]="publishProfileLink" [download]="context?.site.name + '.PublishSettings'"></a>

    <div id="essentials-container" [class.dev-mode]="containerMode === 'Dev'">
      <div class="essentials-col">
        <div>
          <label id="siteStatusLabel">{{'status' | translate}}</label>
          <div tabindex="0"
              id="siteStatusValue"
              aria-labelledby="siteStatusLabel siteStatusValue">
              <img *ngIf="stateIcon"
              [src]="stateIcon" />
              {{state}}
          </div>
        </div>

        <!-- <div [class.invisible]="hideAvailability">
          <label id="siteAvailabilityLabel">{{'availability' | translate}}</label>
          <div [class.site-faded-text]="availabilityState === 'unknown'"
              tabindex="0" id="siteAvailabilityValue"
              aria-labelledby="siteAvailabilityLabel siteAvailabilityValue">
              <img *ngIf="availabilityIcon"
              [src]="availabilityIcon" />
              {{availabilityMesg}}
          </div>
        </div> -->
        <div>
          <label id="containerModeLabel">App Mode</label>
          <div tabindex="0"
              id="siteStatusValue"
              aria-labelledby="siteStatusLabel siteStatusValue">
              <img *ngIf="containerMode == 'Dev'" src="image/error.svg" />
              <img *ngIf="containerMode == 'Prod'" src="image/success.svg" />
              {{ containerMode }}
          </div>
        </div>
      </div>

      <div class="essentials-col">
        <div>
          <label id="siteSubscriptionNameLabel">{{'subscriptionName' | translate}}</label>
          <div>
            <a [class.disabled-link]="isStandalone"
              (click)="openSubscriptionBlade()"
              tabindex="0"
              (keydown)="onKeyPress($event, 'subscription')"
              id="siteSubscriptionNameLink"
              aria-labelledby="siteSubscriptionNameLabel siteSubscriptionNameLink">
              {{subscriptionName}}
            </a>
          </div>
        </div>

        <div>
          <label id="siteSubscriptionLabel">{{'subscription' | translate}}</label>
          <div tabindex="0"
              id="siteSubscriptionValue"
              aria-labelledby="siteSubscriptionLabel siteSubscriptionValue">
              {{subscriptionId}}
          </div>
        </div>
      </div>

      <div class="essentials-col">
        <div>
          <label id="siteResourceGroupLabel">{{'resourceGroup' | translate}}</label>
          <div>
            <a [class.disabled-link]="isStandalone"
            (click)="openResourceGroupBlade()"
            tabindex="0"
            (keydown)="onKeyPress($event, 'resourceGroup')"
            id="siteResourceGroupLink"
            aria-labelledby="siteResourceGroupLabel siteResourceGroupLink">
            {{resourceGroup}}
            </a>
          </div>
        </div>

        <div>
          <label id="siteLocationLabel">{{'location' | translate}}</label>
          <div tabindex="0"
              id="siteLocationValue"
              aria-labelledby="siteLocationLabel siteLocationValue">
              {{location}}
          </div>
        </div>
      </div>

      <div class="essentials-col">
        <div>
          <label id="siteUrlLabel">URL</label>
          <div>
            <a [class.disabled-link]="isStandalone"
              (click)="openMainAppUrl()"
              tabindex="0"
              (keydown)="onKeyPress($event, 'url')"
              id="siteUrlLink"
              aria-labelledby="siteUrlLabel siteUrlLink">
              {{context?.mainSiteUrl}}
            </a>
          </div>
        </div>

        <div>
          <label id="siteAppServicePlanLabel">{{'appServicePlanPricingTier' | translate}}</label>
          <div>
            <a [class.disabled-link]="isStandalone"
              (click)="openPlanBlade()"
              tabindex="0"
              (keydown)="onKeyPress($event, 'appServicePlan')"
              id="siteAppServicePlanLink"
              aria-labelledby="siteAppServicePlanLabel siteAppServicePlanLink">
              {{plan}}
            </a>
          </div>
        </div>
      </div>

    </div>

    <div id="site-summary-body">
      <div *ngIf="!isStandalone" id="site-summary-features">
        <h2>{{ 'enabledFeatures_header' | translate }}</h2>
        <site-enabled-features [siteInput]="context?.site"></site-enabled-features>
      </div>
    </div>


  </div>

  <ng-sidebar #sidebar [(opened)]="sidePanelOpened"
                        [mode]="'over'"
                        [position]="'right'"
                        [closeOnClickOutside]="true"
                        [trapFocus]="false"
                        [autoFocus]="true"
                        [sidebarClass]="'sidebar-new-function'"
                        [ariaLabel]="'Create Function'"
                        [animate]="true"
                        [closeOnClickBackdrop]="false"
                        [showBackdrop]="true">
        <div>

          <div class="headerBox" style="width: 100%; height: 40px; text-align: left; color: #252525; font-size: 14px; line-height: 37px; margin-bottom: 20px;background-color: rgb(229, 237, 216);">
            <div style="background-color: rgb(113, 149, 22); display: inline-block; height: 40px; width: 40px; margin-right: 15px; float: left; padding: 5px;"></div>
            Publish Function App
          </div>
          <div style="padding: 20px 10px 20px 10px">
            <div style="font-size: 16px; padding:20px 0 20px 0">Select an existing function app:</div>

            <drop-down [options]="publishTargets"
                      (value)="selectedPublishTarget = $event"
                      [setDefault]="false">
            </drop-down>
            <div style="padding-top: 20px">
              <button class="custom-button" (click)="onPublish(selectedPublishTarget)">{{ 'Publish' | translate }} </button>
            </div>

            <div style="padding: 50px 0 20px 0; font-size: 16px;">Or publish to a new function app:</div>
            <div style="padding-bottom: 30px">
              <input style="width: 100%" type="text" [(ngModel)]="newFunctionAppName" />
            </div>
            <div>
              <button class="custom-button" (click)="onCreateAndPublish(newFunctionAppName)">{{ 'create' | translate }} </button>
            </div>
          </div>
        </div>
  </ng-sidebar>
</ng-sidebar-container>